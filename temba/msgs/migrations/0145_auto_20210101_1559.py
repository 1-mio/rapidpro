# Generated by Django 2.2.10 on 2021-01-01 15:59

from django.db import migrations, models

SQL = """
CREATE OR REPLACE FUNCTION
  temba_insert_message_label_counts(_msg_id BIGINT, _is_archived BOOLEAN, _count INT)
RETURNS VOID AS $$
BEGIN
  INSERT INTO msgs_labelcount("label_id", "count", "is_archived", "is_squashed")
  SELECT label_id, _count, _is_archived, FALSE FROM msgs_msg_labels WHERE msgs_msg_labels.msg_id = _msg_id;
END;
$$ LANGUAGE plpgsql;
"""


class Migration(migrations.Migration):

    dependencies = [
        ("msgs", "0144_squashed"),
    ]

    operations = [
        migrations.AlterField(
            model_name="msg",
            name="id",
            field=models.BigAutoField(auto_created=True, primary_key=True, serialize=False),
        ),
        migrations.RunSQL(SQL),
    ]
